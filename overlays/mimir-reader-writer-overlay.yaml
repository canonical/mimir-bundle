---
applications:
  backend:
    charm: mimir-worker-k8s
    channel: edge
    scale: 1
    options:
      alertmanager: true
      compactor: true
      store-gateway: true
      ruler: true
      query-scheduler: true
      # uncomment once this issue is solved:
      # https://github.com/canonical/mimir-coordinator-k8s-operator/issues/33
      # overrides-exporter: true
    constraints: arch=amd64
    storage:
      data: kubernetes,1,1024M
    trust: true
  reader:
    charm: mimir-worker-k8s
    channel: edge
    scale: 1
    options:
      querier: true
      query-frontend: true
    constraints: arch=amd64
    storage:
      data: kubernetes,1,1024M
    trust: true

  # reconfigure the ingester to only do write-path
  ingester:
    options:
      distributor: true
      ingester: true

relations:
- - mimir:mimir-cluster
  - reader:mimir-cluster
- - mimir:mimir-cluster
  - backend:mimir-cluster
